---
title: "Rating Scale Analysis"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Internal Consistency (coefficient alpha)

The code can handle a set of input files that represent different forms (e.g., different combinations of age-range and rater). It generates a single .csv output file summarizing internal consistency analysis across all forms. The ouput table is formatted as in this example: 

```{eval = F}
   form      n scale alpha   SEM CI_90    CI_95   
 1 CP     1000 S1     0.08  2.72 '6 - 15  '5 - 16 
 2             S2     0.12  2.73 '6 - 15  '5 - 16 
 3             S3     0.04  2.73 '6 - 15  '5 - 15 
 4             S4     0.03  2.75 '6 - 15  '5 - 16 
 5             S5     0     2.76 '6 - 15  '5 - 16 
 6             TOT    0.52  6.13 '41 - 61 '39 - 63
 7 CT     1000 S1     0.03  2.75 '6 - 15  '5 - 16 
 8             S2     0.08  2.75 '6 - 15  '5 - 16 
 9             S3     0.07  2.73 '6 - 15  '5 - 16 
10             S4     0.04  2.76 '6 - 15  '5 - 16 
```

Where `CI_90` and `CI_95` are the 90% and 95% confidence intervals, respectively. Please note two idiosyncrasies in the output:

* Alpha values are unexpectedly low, because this demonstration analysis uses simulated rating scale data, not data generated by humans.
* The `'` symbol in the `CI` columns is to prevent MS Excel from automatically formatting these numerical rages as dates when it opens the .csv.

#### 1. Load packages, read data, specify input parameters

###### EXECUTABLE CODE
```{r alpha-load, eval = FALSE}
suppressPackageStartupMessages(library(here))
suppressMessages(suppressWarnings(library(tidyverse)))
suppressMessages(library(psych))

urlRemote_path  <- "https://raw.githubusercontent.com/"
github_path <- "DSHerzberg/RATING-SCALE-ANALYSIS/master/INPUT-FILES/"

data_RS_sim_child_parent <- suppressMessages(read_csv(url(
  str_c(urlRemote_path, github_path, "data-RS-sim-child-parent.csv")
)))
data_RS_sim_child_teacher <- suppressMessages(read_csv(url(
  str_c(urlRemote_path, github_path, "data-RS-sim-child-teacher.csv")
)))
data_RS_sim_teen_parent <- suppressMessages(read_csv(url(
  str_c(urlRemote_path, github_path, "data-RS-sim-teen-parent.csv")
)))
data_RS_sim_teen_teacher <- suppressMessages(read_csv(url(
  str_c(urlRemote_path, github_path, "data-RS-sim-teen-teacher.csv")
)))

form_acronyms <- c("cp", "ct", "tp", "tt")

scale_items_suffix <- c("S1", "S2", "S3", "S4", "S5", "TOT")

form_scale_vecs <- map(
  c("form", "scale"),
  ~
    crossing(str_to_upper(form_acronyms), scale_items_suffix) %>%
    set_names(c("form", "scale")) %>%
    pull(!!.x)
) %>%
  set_names(c("form", "scale"))
```

###### COMMENTED SNIPPETS
Load packages for file path specification (`here`), data wrangling (`tidyverse`), and psychometric data simulation and analysis (`psych`).
```{r alpha-load, echo = 1:3, eval = F}
```
Specify file paths and retrieve data from a remote host. The script reads in four input files consisting of simulated rating-scale (`RS`) data:

* `data-RS-sim-child-parent.csv`: `child` age range (5-12 yo), `parent` report
* `data-RS-sim-child-teacher`: `child` age range (5-12 yo), `teacher` report
* `data-RS-sim-teen-parent.csv`: `teen` age range (13-18 yo), `parent` report
* `data-RS-sim-teen-teacher.csv`: `teen` age range (13-18 yo), `teacher` report

```{r alpha-load, echo = 7:21, eval = F}
```
Initialize vectors containing file, variable, and category names, abbrievations, and pre/suffixes. These vectors will be used throughout the script.
